import tweepy, random, time
from dailyGames import getDailyGameTweets

def initApi():
    consumer_key = "qJKpeJQ99g2PL9JSmBScf1vcV"
    consumer_secret = "Ztzo2VsoBPTbbO82lsNbTbEx3fSbsvOeB06pKTKd5Qs98LJXH3"
    access_token = "982034714339966976-hThdIM8H0HDxAmtNuZdKOb7xwnZZ187"
    access_token_secret = "TnznPvU9DJdc7VcTapUkMDLcuLtACiLwC3BelubqB1oNv"
    auth = tweepy.OAuthHandler(consumer_key, consumer_secret)
    auth.set_access_token(access_token, access_token_secret)
    return tweepy.API(auth)

def getTweets():
    tweetFile = open('tweets.txt', 'r')
    tweets = tweetFile.readlines()
    tweetFile.close()
    return tweets

def generateTweets( dailyGames ):
    if dailyGames == False:
        return "Error generating the games today!"
    else:
        tweet = ""
        tweetList = []
        for dailyGame in dailyGames:
            if len( tweet + dailyGame + "\n") < 140:
                tweet = tweet + dailyGame + "\n"
            else:
                tweetList.append(tweet)
                tweet = ""
        tweetList.append(tweet)
        return tweetList

twitterAPI = initApi()
dailyGameTwitterList = generateTweets( getDailyGameTweets() )
        
for twt in dailyGameTwitterList:
    print twt
    twitterAPI.update_status(twt)

    
#while True:
#    randomTweet = tweetList[ random.randrange(len( tweetList)) ]
#    twitterAPI.update_status(randomTweet)
#    time.sleep(60 * 5)
